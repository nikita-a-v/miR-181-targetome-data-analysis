---
title: "position_within_UTR"
author: "Nikita Verheyden"
date: "2023-04-22"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

dir
```{r dir}
setwd("D:/Krueger_Lab/Publications/miR181_paper/Figure2/Position_in_Gene")
```

## packages
```{r packages}
library(cliProfiler)
library(rtracklayer)
library(GenomicRanges)
```


## data
```{r data}
#gff file
gff <- import.gff3("D:/Krueger_Lab/Ribo_Profiling/run15112022M23/ref_genome/gencode.vM23.annotation.gff3.gz")
head(gff)
#binding site data
bsdat <- readRDS("D:/Krueger_Lab/Publications/miR181_paper/Figure1/mir181_binding_sites__venn_types/mir181_bs.rds")
rownames(bsdat) <- 1: length(bsdat$start)
head(bsdat)
bsrange <- makeGRangesFromDataFrame(bsdat, keep.extra.columns = T)
```

#  metaGeneProfile

```{r metaGeneProfile}
meta <- metaGeneProfile(object = bsrange, annotation = gff)

testpath <- system.file("extdata", package = "cliProfiler")
## loading the test GRanges object
test <- readRDS(file.path(testpath, "test.rds"))
## Show an example of GRanges object
test
```

testpath <- system.file("extdata", package = "cliProfiler")
## loading the test GRanges object
test <- readRDS(file.path(testpath, "test.rds"))
## Show an example of GRanges object
test

## the path for the test gff3 file
test_gff3 <- file.path(testpath, "annotation_test.gff3")
## the gff3 file can be loaded by import.gff3 function in rtracklayer package
shown_gff3 <- rtracklayer::import.gff3(test_gff3)
## show the test gff3 file
shown_gff3

meta <- metaGeneProfile(object = test, annotation = test_gff3)
meta[[1]]