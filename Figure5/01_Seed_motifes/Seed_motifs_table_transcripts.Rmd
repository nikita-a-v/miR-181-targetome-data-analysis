---
title: "Seed motifs on transcripts"
author: "Melina Klostermann"
date: "`r format(Sys.time(), '%d %B, %Y')`"
output: 
  # BiocStyle::html_document:
  #   toc_float: TRUE
  #   code_folding: hide
  #   toc: TRUE
  #   number_sections: yes
  #   fig_caption: yes
  pdf_document:
    fig_caption: true
    fig_crop: true
    toc: true
    toc_depth: 1
    number_sections: true
---

```{r setup, include=FALSE}
require("knitr")
knitr::opts_chunk$set(warning=FALSE, message=FALSE, cache=F, cache.lazy = FALSE)
tidy.opts=list(width.cutoff=80,tidy=TRUE, echo=FALSE)
```

# Libraries and settings

```{r libraries}
# ----------------------------------------
# libraries
# ----------------------------------------
library(tidyverse)
library(GenomicRanges)
library(colorspace)
library(gghalves)
library(BSgenome.Mmusculus.UCSC.mm10)
library(Biostrings)
library(plyranges)

here <- here::here()

# ----------------------------------------
# settings
# ----------------------------------------

out <- paste0(here,"/Figure5/01_Seed_motifes/")
source(paste0(here,"/Supporting_scripts/themes/theme_paper.R"))
source(paste0(here,"/Supporting_scripts/themes/CustomThemes.R"))

```

# What was done?

- I count different versions of the miR181 seed in the 200nt before and after mir181 binding sites.

- I use the seed 6mer, 7mers with one adjecent nt, and a 8mer with two adjecent nts.



# Files
```{r}
# -----------------------------------
# transcript sequences
# ------------------------------------
transcript_fasta <- readDNAStringSet("/Users/melinaklostermann/Documents/projects/anno/gencodevM23/gencode.vM23.transcripts.fa.gz") %>% RNAStringSet()

transcript_anno_meta <- names(transcript_fasta) 
transcript_anno_meta <- data.frame(all = transcript_anno_meta) %>%
  tidyr::separate(., col = all,
                  into = c("transcript_id", "gene_id", "a", "b", "isoform_name", "gene_name", "entrez_gene_id", "gene_type"), sep = "\\|")

names_transcript_fasta <- sub("\\..*", "", transcript_anno_meta$transcript_id)

# add N in beginning in end to not run out of transcripts when search motif
n200 <- c(rep("N",200)) %>% 
  paste(., collapse = "") %>%
  RNAStringSet()

transcript_fasta <- xscat(n200, transcript_fasta, n200)
names(transcript_fasta) <- names_transcript_fasta

transcript_fasta_df <- data.frame(tx_name = names(transcript_fasta), width = width(transcript_fasta))

# ----------------------------------------
# MREs
# ----------------------------------------

mir181_bs <- readRDS(paste0(here,"/Figure4/03_assign_transcripts/mir181_bs_on_transcripts.rds"))

mir_crosslinks <- readRDS("/Users/melinaklostermann/Documents/projects/AgoCLIP_miR181/xx_down_stream_R/01_Characterisation_of_chimeric_reads/out/mir_crosslinks_per_cond.rds")


# move bs annotation because transcripts got 200N in beginning
# Achtung! this needs to be shifted back in the end of the script!!!
mir181_bs <- makeGRangesFromDataFrame(mir181_bs, keep.extra.columns = T) %>% 
  shift(., 200) %>%
  as.data.frame(.)

mir181_enriched_set <- mir181_bs %>% 
  subset(set %in% c("ago_bs_mir181_chi&mir181_enriched", "mir181_enriched"))

nrow(mir181_enriched_set)





```

# XSTREME de novo motif discovery

```{r include=TRUE, eval=FALSE}
# get seqeunce 200nt around binding sites

mir181_bs_200_both_sides <- as.data.frame(mir181_enriched_set) %>%
  left_join(transcript_fasta_df, by= c(seqnames = "tx_name"), suffix = c(".bs", ".tx")) %>% 
  mutate(end = end + 197, start = start -197) %>%
  dplyr::filter((end <  width.tx)  & (start > 0)) %>%
  makeGRangesFromDataFrame(., keep.extra.columns = T) 

mir181_bs_200_both_sides_seq <- getSeq(mir181_bs_200_both_sides, x = transcript_fasta) %>% 
  RNAStringSet()

names(mir181_bs_200_both_sides_seq) <- 1:NROW(mir181_bs_200_both_sides_seq)

# write fasta file for XSTREME
writeXStringSet(mir181_bs_200_both_sides_seq, filepath = paste0(out, "mirBS_200_both_sides_transcripts.fasta" ))

#########################
# for revision test other window sizes
########################

# 50 nt
# get seqeunce 200nt around binding sites

mir181_bs_50_both_sides <- as.data.frame(mir181_enriched_set) %>%
  left_join(transcript_fasta_df, by= c(seqnames = "tx_name"), suffix = c(".bs", ".tx")) %>% 
  mutate(end = end + 47, start = start -47) %>%
  dplyr::filter((end <  width.tx)  & (start > 0)) %>%
  makeGRangesFromDataFrame(., keep.extra.columns = T) 

mir181_bs_50_both_sides_seq <- getSeq(mir181_bs_50_both_sides, x = transcript_fasta) %>% 
  RNAStringSet()

names(mir181_bs_50_both_sides_seq) <- 1:NROW(mir181_bs_50_both_sides_seq)

# write fasta file for XSTREME
writeXStringSet(mir181_bs_50_both_sides_seq, filepath = paste0(out, "mirBS_50_both_sides_transcripts.fasta" ))


# get seqeunce 200nt around binding sites

mir181_bs_500_both_sides <- as.data.frame(mir181_enriched_set) %>%
  left_join(transcript_fasta_df, by= c(seqnames = "tx_name"), suffix = c(".bs", ".tx")) %>% 
  mutate(end = end + 497, start = start -497) %>%
  dplyr::filter((end <  width.tx)  & (start > 0)) %>%
  makeGRangesFromDataFrame(., keep.extra.columns = T) 

mir181_bs_500_both_sides_seq <- getSeq(mir181_bs_500_both_sides, x = transcript_fasta) %>% 
  RNAStringSet()

names(mir181_bs_500_both_sides_seq) <- 1:NROW(mir181_bs_500_both_sides_seq)

# write fasta file for XSTREME
writeXStringSet(mir181_bs_500_both_sides_seq, filepath = paste0(out, "mirBS_500_both_sides_transcripts.fasta" ))



```


XSTREME is executed on the fasta file from above via the MEME SUITE webpage (https://meme-suite.org/meme/tools/xstreme) with the following parameters:

- E-value <= 0.05
- Width 5-10
- background: model control sequences
- STREME limit: Number of motifes = 20
- MEME options: Default E-value, Zero or one occurence per sequence
- SEA: 	Output the matching sequences in a TSV file


```{r eval=FALSE, include=FALSE}
# plot logo
motif <- read.table(paste0(here, "/Figure5/01_Seed_motifes/XSTREAME_output/xstreme_motif1.txt"))

colnames(motif) <- c("A", "C", "G", "U")
motif <- t(motif)

logo <- ggseqlogo::ggseqlogo(motif)

logo

ggsave(logo, filename = paste0(out, "Figure5F_xstreme_logo.pdf"), height = 6, width = 8, units = "cm")

#####################
# for revision
####################
# plot logo in 50nt window

motif <- read.table(paste0(here, "/Figure5/01_Seed_motifes/XSTREAME_output/xstreme_motif1.txt"))

colnames(motif) <- c("A", "C", "G", "U")
motif <- t(motif)

logo <- ggseqlogo::ggseqlogo(motif)

logo

ggsave(logo, filename = paste0(out, "Figure5F_xstreme_logo.pdf"), height = 6, width = 8, units = "cm")


# plot logo in 50nt window

motif2 <- read.table(paste0(here, "/Figure5/01_Seed_motifes/XSTREAME_out_50nt/xstreme_motif1.txt"))

colnames(motif2) <- c("A", "C", "G", "U")
motif2 <- t(motif2)

logo2 <- ggseqlogo::ggseqlogo(motif2)

logo2

ggsave(logo2, filename = paste0(out, "Revision_xstreme_logo_50nt.pdf"), height = 6, width = 8, units = "cm")


# plot logo in 500nt window

motif3 <- read.table(paste0(here, "/Figure5/01_Seed_motifes/XSTREAME_out_500nt/xstreme_motif1.txt"))

colnames(motif3) <- c("A", "C", "G", "U")
motif3 <- t(motif3)

logo3 <- ggseqlogo::ggseqlogo(motif3)

logo3

ggsave(logo3, filename = paste0(out, "Revision_xstreme_logo_500nt.pdf"), height = 6, width = 8, units = "cm")

```

```{r}
#################
# the mir181 seed and interesting seed variations
#################

seed_8mer <- "UGAAUGUA"
seed_7mer_m8 <- "UGAAUGU"
seed_7mer_a1 <- "GAAUGUA"
seed_6mer <- "GAAUGU"
seed_6mer_wobble <- "GAUUGU"
seed_8mer_wobble <- "UGAUUGUA"
seed_7mer_m8_wobble <- "UGAUUGU"
seed_7mer_a1_wobble <- "GAUUGUA"

seed_alt_38 <- "UGAAUG"
seed_alt_38_wobble <- "UGAUUG"


# make a list of all seeds
seed_list <- list(seed_8mer, seed_7mer_m8, seed_7mer_a1,seed_6mer, seed_6mer_wobble, seed_8mer_wobble, seed_7mer_m8_wobble, seed_7mer_a1_wobble, seed_alt_38, seed_alt_38_wobble  )

seed_names_list <- list( "seed_8mer",  "seed_7mer_m8", "seed_7mer_a1",  "seed_6mer", "seed_6mer_wobble", "seed_8mer_wobble", "seed_7mer_m8_wobble", "seed_7mer_a1_wobble", "seed_alt_38", "seed_alt_38_wobble" )

# hierarchy order, to decide which seed to use if several ar present
seed_importance_order <- c("seed_8mer",  "seed_7mer_m8", "seed_7mer_a1",  "seed_6mer", "seed_alt_38", "seed_alt_38_wobble")

```

# Seed position and distribution

## 200nt after the binding site

```{r}
#######################
# get seed in 200er window
#######################

mir181_bs_200down <- as.data.frame(mir181_enriched_set) %>%
  left_join(transcript_fasta_df, by= c(seqnames = "tx_name"), suffix = c(".bs", ".tx")) %>% 
  mutate(end = end + 200) %>%
  dplyr::filter((end <  width.tx)  & (start > 0)) %>%
  makeGRangesFromDataFrame(., keep.extra.columns =T) 

mir181_bs_200down_seq <- getSeq(mir181_bs_200down, x = transcript_fasta) %>% 
  RNAStringSet()

# count occurences of all seed variations
Seeds_200down <- lapply(seed_list, function(x) {
  vmatchPattern(pattern = x, mir181_bs_200down_seq) %>% 
  lapply(., function(x) as.data.frame(x))})

# add the binding site id to the seeds and make a df per seed type
BS_ID_list <- as.list(mir181_bs_200down$mir181BS_ID)

Seeds_200down <- map(Seeds_200down, 
                     ~map2(.x, BS_ID_list, ~mutate(.x, mir181BS_ID = .y) ) %>% 
               map_dfr(~.x))


# add the seed type names and make one df of all
Seeds_200down <- map2(Seeds_200down, seed_names_list, ~mutate(.x, seed = .y) ) %>% map_dfr(~.x)


# extract wobble positions
Seeds_1_per_BS <- Seeds_200down %>% 
  mutate(wobble = grepl("wobble", seed),
         seed = case_when(wobble  ~ substr(seed, 1, nchar(seed)-7), T ~ seed))


# order seeds by importance
Seeds_1_per_BS$seed <- factor(Seeds_1_per_BS$seed, levels = seed_importance_order )

# select 1 seed per BS --> closest seed with highest importance
Seeds_1_per_BS <- Seeds_1_per_BS %>%
   group_by(mir181BS_ID) %>%
  arrange(start, seed ) %>%
  dplyr::slice(1) %>%
  ungroup(.) 

########################
# combine the closest seed, and all found seeds to the Binding site data.frame
#######################

# add all as list column

colnames(Seeds_200down) <- c("Seeds_200down.start",
                             "Seeds_200down.end",
                             "Seeds_200down.width",
                             "mir181BS_ID",
                             "Seeds_200down.type")


mir181_bs <- left_join(mir181_bs, Seeds_200down, by = "mir181BS_ID") %>%
  tidyr::nest(all_seeds_200down = c("Seeds_200down.start",
                             "Seeds_200down.end",
                             "Seeds_200down.width",
                             "Seeds_200down.type"))

# add closest mir
colnames(Seeds_1_per_BS) <- c("first_seed_200down.start",
                             "first_seed_200down.end",
                             "first_seed_200down.width",
                             "mir181BS_ID",
                             "first_seed_200down.type",
                             "first_seed_200down.wobble")

mir181_bs <- left_join(mir181_bs, Seeds_1_per_BS, by = "mir181BS_ID") 

mir181_bs <- mir181_bs %>% 
  rowwise() %>% 
  mutate(seed_repetitions.200down = sum(all_seeds_200down$Seeds_200down.type == "seed_6mer"),
        seed_repetitions.200down.wobble = sum(all_seeds_200down$Seeds_200down.type == "seed_6mer_wobble") )



```

```{r}
###################
# plots
###################

# plot seed variations SuppFigure5C
####################################
p <- ggplot(mir181_bs %>% subset(set %in% c("ago_bs_mir181_chi&mir181_enriched", "mir181_enriched")) %>% subset(!is.na(first_seed_200down.type)), aes(x = first_seed_200down.type, fill = first_seed_200down.wobble))+
  geom_bar(color = "black")+
  theme_paper()+
  scale_fill_manual(values = c("blue", "yellow"))+
  theme(legend.position = "None") +
  scale_x_discrete(labels=c(seed_8mer = "U*GAA/UUGU*A",
                            seed_7mer_m8 = "U*GAA/UUGU",
                            seed_7mer_a1 = "GAA/UUGU*A",
                            seed_6mer = "GAA/UUGU",
                            seed_alt_38 = "UGAA/UUG"),
                   guide = guide_axis(angle = 25))
  
p+
  ggtitle("mir181 seed variations in 200nt after the binding site", 
          subtitle = "in case of mutiple seeds the seed nearest to the bindingsite in used")

# plot seed versions Figure5B
#############################
p1 <- ggplot(mir181_bs %>% subset(set %in% c("ago_bs_mir181_chi&mir181_enriched", "mir181_enriched")) %>% subset(!is.na(first_seed_200down.type))%>%
               subset(first_seed_200down.wobble == F), aes(x = first_seed_200down.type))+
  geom_bar(color = "black")+
  theme_paper()+
  theme(legend.position = "None") +
  scale_x_discrete(labels=c(seed_8mer = "U*GAA/UUGU*A",
                            seed_7mer_m8 = "U*GAA/UUGU",
                            seed_7mer_a1 = "GAA/UUGU*A",
                            seed_6mer = "GAA/UUGU",
                            seed_alt_38 = "UGAA/UUG"),
                   guide = guide_axis(angle = 25))
  
p1+
  ggtitle("mir181 seed variations in 200nt after the binding site", 
          subtitle = "in case of mutiple seeds the seed nearest to the bindingsite in used")

# plot seed position
####################
p2 <- ggplot(unnest(mir181_bs) %>% 
               subset(Seeds_200down.type %in% c("seed_6mer", "seed_6mer_wobble")) %>%
               subset(set %in% c("ago_bs_mir181_chi&mir181_enriched", "mir181_enriched")), aes(x = Seeds_200down.start))+
  geom_histogram(color = "black", binwidth = 1)+
  theme_paper()

p2+
  ggtitle("mir181 seed positions", 
          subtitle = "in case of mutiple seeds all are used")

# plot wobble seed position
###########################
p3 <- ggplot(unnest(mir181_bs) %>% subset(Seeds_200down.type == "seed_6mer_wobble") %>% subset(set %in% c("ago_bs_mir181_chi&mir181_enriched", "mir181_enriched")), aes(x = Seeds_200down.start))+
  geom_histogram(color = "black", binwidth = 1)+
  theme_paper()
p3+
  ggtitle("mir181 wobble seed positions", 
          subtitle = "in case of mutiple seeds all are used")




# get numbers for text
#######################
t <- mir181_bs %>% subset(set %in% c("ago_bs_mir181_chi&mir181_enriched", "mir181_enriched")) %>%
  pull(first_seed_200down.wobble) %>%
  table()
 
t

t/sum(t)


b <- nrow(mir181_bs %>% subset(set %in% c("ago_bs_mir181_chi&mir181_enriched", "mir181_enriched")))

a <- mir181_bs %>% subset(set %in% c("ago_bs_mir181_chi&mir181_enriched", "mir181_enriched")) %>%
  subset(first_seed_200down.wobble == F) 

nrow(a)

nrow(a)/b






ggsave(p, filename = paste0(out, "SuppFigure5C_seed_versions.pdf"), width = 6, height = 6, units = "cm"  )
ggsave(p1, filename = paste0(out, "Figure5B_seed_versions.pdf"), width = 6, height = 6, units = "cm"  )
ggsave(p2, filename = paste0(out, "Figure5C_seed_position_after_BS.pdf"), width = 6, height = 6, units = "cm"  )
ggsave(p3, filename = paste0(out, "Figure5H_wobbleseed_position_after_BS.pdf"), width = 6, height = 4, units = "cm"  )

```


### percent binding sites with a seed downstream
```{r}
nrow(mir181_bs %>% subset(set %in% c("ago_bs_mir181_chi&mir181_enriched", "mir181_enriched")) %>% subset(!is.na(first_seed_200down.start)))/ nrow(mir181_bs %>% subset(set %in% c("ago_bs_mir181_chi&mir181_enriched", "mir181_enriched")))
```


# Make table of 6mers on transcripts
```{r}
# ! shift transcript positions 200nt back!!!
mir181_bs <- makeGRangesFromDataFrame(mir181_bs, keep.extra.columns = T) %>%
  shift(., shift = -200) %>% as.data.frame(.)

# get 6mers per bs
seeds_tx <- mir181_bs %>% unnest(all_seeds_200down) %>% 
  subset(!is.na(Seeds_200down.start)) %>%
  makeGRangesFromDataFrame(., keep.extra.columns = T)

seeds_tx <- shift(seeds_tx, seeds_tx$Seeds_200down.start -1)

seeds_tx <- resize(seeds_tx, width = seeds_tx$Seeds_200down.width, fix = "start")

```

# For revision

## 500nt on both sides of the binding site

```{r}
#######################
# get seed in 200er window
#######################

mir181_bs_500down <- as.data.frame(mir181_enriched_set) %>%
  left_join(transcript_fasta_df, by= c(seqnames = "tx_name"), suffix = c(".bs", ".tx")) %>% 
  mutate(end = end + 500) %>%
  mutate(start = start - 500) %>%
  dplyr::filter((end <  width.tx)  & (start > 0)) %>%
  makeGRangesFromDataFrame(., keep.extra.columns =T) 

mir181_bs_500down_seq <- getSeq(mir181_bs_500down, x = transcript_fasta) %>% 
  RNAStringSet()

# count occurences of all seed variations
Seeds_500down <- lapply(seed_list, function(x) {
  vmatchPattern(pattern = x, mir181_bs_500down_seq) %>% 
  lapply(., function(x) as.data.frame(x))})

# add the binding site id to the seeds and make a df per seed type
BS_ID_list <- as.list(mir181_bs_500down$mir181BS_ID)

Seeds_500down <- map(Seeds_500down, 
                     ~map2(.x, BS_ID_list, ~mutate(.x, mir181BS_ID = .y) ) %>% 
               map_dfr(~.x))


# add the seed type names and make one df of all
Seeds_500down <- map2(Seeds_500down, seed_names_list, ~mutate(.x, seed = .y) ) %>% map_dfr(~.x)


# extract wobble positions
Seeds_500down <- Seeds_500down %>% 
  mutate(wobble = grepl("wobble", seed),
         seed = case_when(wobble  ~ substr(seed, 1, nchar(seed)-7), T ~ seed))



ggplot(Seeds_500down %>% subset(seed = "seed_6mer"), aes(x = start))+
  geom_rect(inherit.aes=FALSE, aes(xmin=500, xmax=700, ymin = 0, ymax = 0.0025), color="transparent", fill="orange", alpha=0.01)+
  geom_density()+
  theme_bw()+
  scale_x_continuous(breaks = c(100,300, 500, 700, 900), labels = c("-400", "-200", "0", "200", "400"))

ggsave(paste0(out, "Revision_seed_densito_around_bs.pdf"), height = 6, width = 8, units ="cm")

```

```{r}
###################
# plots
###################

# plot seed variations SuppFigure5C
####################################
p <- ggplot(mir181_bs %>% subset(set %in% c("ago_bs_mir181_chi&mir181_enriched", "mir181_enriched")) %>% subset(!is.na(first_seed_200down.type)), aes(x = first_seed_200down.type, fill = first_seed_200down.wobble))+
  geom_bar(color = "black")+
  theme_paper()+
  scale_fill_manual(values = c("blue", "yellow"))+
  theme(legend.position = "None") +
  scale_x_discrete(labels=c(seed_8mer = "U*GAA/UUGU*A",
                            seed_7mer_m8 = "U*GAA/UUGU",
                            seed_7mer_a1 = "GAA/UUGU*A",
                            seed_6mer = "GAA/UUGU",
                            seed_alt_38 = "UGAA/UUG"),
                   guide = guide_axis(angle = 25))
  
p+
  ggtitle("mir181 seed variations in 200nt after the binding site", 
          subtitle = "in case of mutiple seeds the seed nearest to the bindingsite in used")

# plot seed versions Figure5B
#############################
p1 <- ggplot(mir181_bs %>% subset(set %in% c("ago_bs_mir181_chi&mir181_enriched", "mir181_enriched")) %>% subset(!is.na(first_seed_200down.type))%>%
               subset(first_seed_200down.wobble == F), aes(x = first_seed_200down.type))+
  geom_bar(color = "black")+
  theme_paper()+
  theme(legend.position = "None") +
  scale_x_discrete(labels=c(seed_8mer = "U*GAA/UUGU*A",
                            seed_7mer_m8 = "U*GAA/UUGU",
                            seed_7mer_a1 = "GAA/UUGU*A",
                            seed_6mer = "GAA/UUGU",
                            seed_alt_38 = "UGAA/UUG"),
                   guide = guide_axis(angle = 25))
  
p1+
  ggtitle("mir181 seed variations in 200nt after the binding site", 
          subtitle = "in case of mutiple seeds the seed nearest to the bindingsite in used")

# plot seed position
####################
p2 <- ggplot(unnest(mir181_bs) %>% 
               subset(Seeds_200down.type %in% c("seed_6mer", "seed_6mer_wobble")) %>%
               subset(set %in% c("ago_bs_mir181_chi&mir181_enriched", "mir181_enriched")), aes(x = Seeds_200down.start))+
  geom_histogram(color = "black", binwidth = 1)+
  theme_paper()

p2+
  ggtitle("mir181 seed positions", 
          subtitle = "in case of mutiple seeds all are used")

# plot wobble seed position
###########################
p3 <- ggplot(unnest(mir181_bs) %>% subset(Seeds_200down.type == "seed_6mer_wobble") %>% subset(set %in% c("ago_bs_mir181_chi&mir181_enriched", "mir181_enriched")), aes(x = Seeds_200down.start))+
  geom_histogram(color = "black", binwidth = 1)+
  theme_paper()
p3+
  ggtitle("mir181 wobble seed positions", 
          subtitle = "in case of mutiple seeds all are used")




# get numbers for text
#######################
t <- mir181_bs %>% subset(set %in% c("ago_bs_mir181_chi&mir181_enriched", "mir181_enriched")) %>%
  pull(first_seed_200down.wobble) %>%
  table()
 
t

t/sum(t)


b <- nrow(mir181_bs %>% subset(set %in% c("ago_bs_mir181_chi&mir181_enriched", "mir181_enriched")))

a <- mir181_bs %>% subset(set %in% c("ago_bs_mir181_chi&mir181_enriched", "mir181_enriched")) %>%
  subset(first_seed_200down.wobble == F) 

nrow(a)

nrow(a)/b






ggsave(p, filename = paste0(out, "SuppFigure5C_seed_versions.pdf"), width = 6, height = 6, units = "cm"  )
ggsave(p1, filename = paste0(out, "Figure5B_seed_versions.pdf"), width = 6, height = 6, units = "cm"  )
ggsave(p2, filename = paste0(out, "Figure5C_seed_position_after_BS.pdf"), width = 6, height = 6, units = "cm"  )
ggsave(p3, filename = paste0(out, "Figure5H_wobbleseed_position_after_BS.pdf"), width = 6, height = 4, units = "cm"  )

```





# Save tables

```{r}
saveRDS(mir181_bs, file = paste0(out, "mir181_bs_with_seeds_transcripts.rds"))
saveRDS(seeds_tx, file = paste0(out, "seeds_transcripts.rds"))

t <- mir181_bs %>% as.data.frame() %>%
   subset(set %in% c("mir181_enriched", "ago_bs_mir181_chi&mir181_enriched"))

write_csv(t, paste0(out, "STable6_MREs_transcripts_seeds.csv"))

```

# Session Info

```{r}
sessionInfo()

```

